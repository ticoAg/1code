<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline';">
    <title>21st - Login</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      /* Dark theme (default) */
      :root {
        --bg: #09090b;
        --text: #fafafa;
        --text-logo: #fafafa;
        --btn-shadow: 0 0 0 0.5px rgb(23,23,23), inset 0 0 0 1px rgba(255,255,255,0.14);
      }

      /* Light theme */
      @media (prefers-color-scheme: light) {
        :root {
          --bg: #ffffff;
          --text: #09090b;
          --text-logo: #09090b;
          --btn-shadow: 0 0 0 0.5px rgba(0,0,0,0.1), inset 0 0 0 1px rgba(0,0,0,0.1);
        }
      }

      body {
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', sans-serif;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        height: 100vh;
        margin: 0;
        background: var(--bg);
        color: var(--text);
        -webkit-app-region: drag;
      }
      .container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 20px;
        -webkit-app-region: no-drag;
      }
      .logo {
        height: 72px;
        width: auto;
      }
      .logo .text-path {
        fill: var(--text-logo);
      }
      .login-btn {
        height: 32px;
        padding: 0 12px;
        background: hsl(228 100% 50%);
        color: #fafafa;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 14px;
        font-weight: 500;
        transition: background-color 0.15s ease, transform 0.15s ease;
        box-shadow: var(--btn-shadow);
      }
      .login-btn:hover {
        background: hsl(228 100% 45%);
      }
      .login-btn:active {
        transform: scale(0.97);
      }
    </style>
  </head>
  <body>
    <div class="container">
      <!-- LogoWithText SVG -->
      <svg class="logo" viewBox="0 0 84 40" fill="none" xmlns="http://www.w3.org/2000/svg">
        <!-- T -->
        <path class="text-path" d="M67.3762 26.1952H64.6912V16.059H60.9882V13.8769H71.0791V16.059H67.3762V26.1952Z"/>
        <!-- S -->
        <path class="text-path" d="M55.7902 26.4016C54.6976 26.4016 53.7519 26.2375 52.953 25.9093C52.1659 25.5693 51.555 25.0946 51.1203 24.4851C50.6974 23.8638 50.4859 23.1371 50.4859 22.3049H53.2702C53.2937 23.0199 53.4876 23.5356 53.8517 23.8521C54.2277 24.1569 54.8621 24.3093 55.7549 24.3093C56.6125 24.3093 57.2176 24.1979 57.57 23.9752C57.9224 23.7525 58.0987 23.3715 58.0987 22.8323C58.0987 22.3986 57.9812 22.0821 57.7462 21.8829C57.523 21.6719 57.106 21.5019 56.4951 21.373L54.2218 20.8983C53.0588 20.6638 52.1718 20.2594 51.5609 19.6851C50.9617 19.1107 50.6621 18.384 50.6621 17.5049C50.6621 16.7547 50.8677 16.0865 51.2789 15.5005C51.6901 14.9027 52.2716 14.4397 53.0235 14.1115C53.7871 13.7715 54.6682 13.6016 55.6668 13.6016C56.6654 13.6016 57.5465 13.7657 58.3101 14.0939C59.0855 14.4221 59.6847 14.8909 60.1076 15.5005C60.5423 16.0983 60.7596 16.7957 60.7596 17.5928H57.9753C57.9283 16.8895 57.7286 16.3972 57.3762 16.1158C57.0237 15.8345 56.4363 15.6939 55.614 15.6939C54.8151 15.6939 54.2512 15.8052 53.9222 16.0279C53.5933 16.2506 53.4229 16.6316 53.4112 17.1708C53.4112 17.5693 53.5228 17.8741 53.746 18.0851C53.981 18.2961 54.4157 18.466 55.05 18.595L57.2176 19.0169C58.4629 19.2514 59.4027 19.6616 60.0371 20.2477C60.6715 20.8221 60.9887 21.5547 60.9887 22.4455C60.9887 23.2074 60.7772 23.8873 60.3543 24.4851C59.9431 25.0829 59.344 25.5517 58.5568 25.8917C57.7815 26.2316 56.8592 26.4016 55.7902 26.4016Z"/>
        <!-- 1 -->
        <path class="text-path" d="M46.7281 26.1952V18.3291H43.8145V16.3581L44.9976 16.2701C45.6333 16.2232 46.0983 16.0707 46.3926 15.8126C46.6987 15.5428 46.8811 15.1439 46.94 14.616L47.0283 13.8769H49.3062V26.1952H46.7281Z"/>
        <!-- 2 -->
        <path class="text-path" d="M34 26.1951V23.7787L39.0131 19.8631C39.4132 19.5456 39.7074 19.2692 39.8957 19.0341C40.084 18.7871 40.2075 18.5402 40.2664 18.2933C40.3252 18.0346 40.3546 17.7053 40.3546 17.3055C40.3546 16.6823 40.2252 16.2531 39.9663 16.018C39.7074 15.7828 39.2308 15.6652 38.5365 15.6652C38.0069 15.677 37.6068 15.7534 37.3362 15.8945C37.0773 16.0239 36.9008 16.2473 36.8066 16.5648C36.7125 16.8705 36.6713 17.3114 36.6831 17.8876H34.053C33.9823 16.4883 34.3648 15.4242 35.2003 14.6951C36.0358 13.9661 37.1891 13.6016 38.6601 13.6016C40.0251 13.6016 41.1078 13.9132 41.908 14.5364C42.7082 15.1478 43.1083 16.0591 43.1083 17.2703C43.1083 18.1404 42.8788 18.8988 42.4199 19.5456C41.9609 20.1805 41.1842 20.9096 40.0898 21.7327L37.901 23.4083V24.1138H43.2671V26.1951H34Z"/>
        <!-- Icon -->
        <path fill-rule="evenodd" clip-rule="evenodd" d="M26.3333 12C27.2538 12 28 12.7462 28 13.6667V23.8333C28 23.9254 27.9254 24 27.8333 24H22.8333C22.7413 24 22.6667 24.0746 22.6667 24.1667V27.8333C22.6667 27.9254 22.592 28 22.5 28H13.6667C12.7462 28 12 27.2538 12 26.3333V24.1888C12 24.0717 12.0617 23.9632 12.1621 23.903L18.1504 20.3099C18.2864 20.2283 18.2408 20.0272 18.0951 20.0026L18.0651 20H12.1667C12.0746 20 12 19.9254 12 19.8333V16.1667C12 16.0746 12.0746 16 12.1667 16H18.5C18.592 16 18.6667 15.9254 18.6667 15.8333V12.1667C18.6667 12.0746 18.7413 12 18.8333 12H26.3333ZM18.8333 16C18.7413 16 18.6667 16.0746 18.6667 16.1667V23.8333C18.6667 23.9254 18.7413 24 18.8333 24H22.5C22.592 24 22.6667 23.9254 22.6667 23.8333V16.1667C22.6667 16.0746 22.592 16 22.5 16H18.8333Z" fill="#0033FF"/>
      </svg>
      <button class="login-btn" id="loginBtn">Sign in</button>
    </div>
    <script>
      console.log('Login page loaded');
      console.log('window.desktopApi:', window.desktopApi);

      // Listen for auth success from main process (via deep link)
      // This ensures UI updates even if deep link arrives before click handler completes
      if (window.desktopApi && window.desktopApi.onAuthSuccess) {
        window.desktopApi.onAuthSuccess(function(user) {
          console.log('[Login] Auth success received:', user?.email);
          // Window will be reloaded by main process, no UI change needed
        });
      }

      document.getElementById('loginBtn').addEventListener('click', function() {
        console.log('Sign in clicked');
        console.log('desktopApi available:', !!window.desktopApi);

        if (window.desktopApi && window.desktopApi.startAuthFlow) {
          console.log('Calling startAuthFlow...');
          window.desktopApi.startAuthFlow();
        } else {
          console.error('Desktop API not available');
          alert('Desktop API not available. Please restart the app.');
        }
      });
    </script>
  </body>
</html>
